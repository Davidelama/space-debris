import numpy as np

# ============================================================================
# TABELLA 1: U.S. Standard Atmosphere 1976 (unità SI)
# ============================================================================

# Da -2 km a 84.852 km
ussa1976_altitude = np.array([
    -2000, -1000, 0, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000,
    12000, 15000, 20000, 25000, 30000, 35000, 40000, 45000, 50000, 60000, 70000,
    80000, 84852
])  # metri

ussa1976_temperature = np.array([
    301.15, 294.65, 288.15, 281.65, 275.15, 268.65, 262.15, 255.65, 249.15, 242.65,
    236.15, 229.65, 223.15, 216.65, 216.65, 216.65, 221.65, 226.65, 237.05, 251.05,
    265.05, 270.65, 245.45, 217.45, 196.65, 186.95
])  # Kelvin

ussa1976_pressure = np.array([
    1.27774E+5, 1.13929E+5, 1.01325E+5, 8.98746E+4, 7.94952E+4, 7.01085E+4,
    6.16402E+4, 5.40199E+4, 4.71810E+4, 4.10607E+4, 3.55998E+4, 3.07425E+4,
    2.64363E+4, 1.93304E+4, 1.20446E+4, 5.47489E+3, 2.51102E+3, 1.17187E+3,
    5.58924E+2, 2.77522E+2, 1.43135E+2, 7.59448E+1, 2.03143E+1, 4.63422,
    8.86280E-1, 3.73384E-1
])  # Pascal

ussa1976_density = np.array([
    1.47808, 1.34700, 1.22500, 1.11164, 1.00649, 9.09122E-1, 8.19129E-1, 7.36116E-1,
    6.59697E-1, 5.89501E-1, 5.25168E-1, 4.66348E-1, 4.12707E-1, 3.10828E-1,
    1.93674E-1, 8.80349E-2, 3.94658E-2, 1.80119E-2, 8.21392E-3, 3.85101E-3,
    1.88129E-3, 9.77525E-4, 2.88321E-4, 7.42430E-5, 1.57005E-5, 6.95788E-6
])  # kg/m³

ussa1976_viscosity = np.array([
    1.87630E-5, 1.84434E-5, 1.81206E-5, 1.77943E-5, 1.74645E-5, 1.71311E-5,
    1.67940E-5, 1.64531E-5, 1.61084E-5, 1.57596E-5, 1.54068E-5, 1.50498E-5,
    1.46884E-5, 1.43226E-5, 1.43226E-5, 1.43226E-5, 1.46044E-5, 1.48835E-5,
    1.54559E-5, 1.62096E-5, 1.69449E-5, 1.72341E-5, 1.59104E-5, 1.43679E-5,
    1.31682E-5, 1.25915E-5
])  # N-s/m²

# ============================================================================
# TABELLA 2: MSISE-90 Model - Bassa attività solare (0-900 km)
# ============================================================================

msise90_low_altitude = np.array([
    0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300,
    320, 340, 360, 380, 400, 420, 440, 460, 480, 500, 520, 540, 560, 580, 600,
    620, 640, 660, 680, 700, 720, 740, 760, 780, 800, 820, 840, 860, 880, 900
]) * 1000  # converti km in metri

msise90_low_temperature = np.array([
    300.2511, 206.2085, 257.6979, 244.1212, 203.1065, 168.7219, 356.8669, 545.8594,
    630.0652, 667.8662, 684.9187, 692.6487, 696.1697, 697.7811, 698.5220, 698.8644,
    699.0233, 699.0973, 699.1320, 699.1483, 699.1561, 699.1597, 699.1615, 699.1623,
    699.1627, 699.1629, 699.1630, 699.1630, 699.1631, 699.1631, 699.1631, 699.1631,
    699.1631, 699.1631, 699.1631, 699.1631, 699.1631, 699.1631, 699.1631, 699.1631,
    699.1631, 699.1631, 699.1631, 699.1631, 699.1631, 699.1631
])  # Kelvin

msise90_low_density = np.array([
    1.17E+00, 9.48E-02, 4.07E-03, 3.31E-04, 1.69E-05, 5.77E-07, 1.70E-08, 2.96E-09,
    9.65E-10, 3.90E-10, 1.75E-10, 8.47E-11, 4.31E-11, 2.30E-11, 1.27E-11, 7.22E-12,
    4.21E-12, 2.50E-12, 1.51E-12, 9.20E-13, 5.68E-13, 3.54E-13, 2.23E-13, 1.42E-13,
    9.20E-14, 6.03E-14, 4.03E-14, 2.75E-14, 1.93E-14, 1.39E-14, 1.03E-14, 7.90E-15,
    6.24E-15, 5.06E-15, 4.21E-15, 3.58E-15, 3.09E-15, 2.70E-15, 2.39E-15, 2.13E-15,
    1.91E-15, 1.73E-15, 1.56E-15, 1.42E-15, 1.30E-15, 1.18E-15
])  # kg/m³

msise90_low_pressure = np.array([
    1.01E+05, 5.62E+03, 3.01E+02, 2.32E+01, 9.81E-01, 2.89E-02, 1.92E-03, 5.37E-04,
    2.13E-04, 9.62E-05, 4.70E-05, 2.43E-05, 1.31E-05, 7.31E-06, 4.20E-06, 2.47E-06,
    1.48E-06, 9.01E-07, 5.57E-07, 3.50E-07, 2.23E-07, 1.45E-07, 9.61E-08, 6.54E-08,
    4.59E-08, 3.32E-08, 2.49E-08, 1.94E-08, 1.55E-08, 1.28E-08, 1.09E-08, 9.40E-09,
    8.27E-09, 7.36E-09, 6.62E-09, 6.00E-09, 5.48E-09, 5.02E-09, 4.63E-09, 4.28E-09,
    3.96E-09, 3.68E-09, 3.43E-09, 3.21E-09, 3.00E-09, 2.81E-09
])  # Pascal

# ============================================================================
# TABELLA 3: MSISE-90 Model - Attività solare media (0-900 km completo)
# ============================================================================

msise90_mean_altitude = np.array([
    0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300,
    320, 340, 360, 380, 400, 420, 440, 460, 480, 500, 520, 540, 560, 580, 600,
    620, 640, 660, 680, 700, 720, 740, 760, 780, 800, 820, 840, 860, 880, 900
]) * 1000  # converti km in metri

msise90_mean_temperature = np.array([
    300.2511, 206.2085, 257.6979, 244.1212, 196.3636, 184.0160, 374.9715, 635.5703,
    787.5532, 877.6729, 931.2806, 963.2701, 982.4191, 993.9173, 1000.8427, 1005.0267,
    1007.5620, 1009.1030, 1010.0423, 1010.6166, 1010.9688, 1011.1853, 1011.3190,
    1011.4014, 1011.4526, 1011.4845, 1011.5043, 1011.5168, 1011.5245, 1011.5294,
    1011.5325, 1011.5345, 1011.5357, 1011.5365, 1011.5370, 1011.5374, 1011.5375,
    1011.5377, 1011.5377, 1011.5378, 1011.5378, 1011.5378, 1011.5379, 1011.5379,
    1011.5379, 1011.5379
])  # Kelvin

msise90_mean_density = np.array([
    1.17E+00, 9.49E-02, 4.07E-03, 3.31E-04, 1.68E-05, 5.08E-07, 1.80E-08, 3.26E-09,
    1.18E-09, 5.51E-10, 2.91E-10, 1.66E-10, 9.91E-11, 6.16E-11, 3.94E-11, 2.58E-11,
    1.72E-11, 1.16E-11, 7.99E-12, 5.55E-12, 3.89E-12, 2.75E-12, 1.96E-12, 1.40E-12,
    1.01E-12, 7.30E-13, 5.31E-13, 3.88E-13, 2.85E-13, 2.11E-13, 1.56E-13, 1.17E-13,
    8.79E-14, 6.65E-14, 5.08E-14, 3.91E-14, 3.04E-14, 2.39E-14, 1.90E-14, 1.53E-14,
    1.25E-14, 1.03E-14, 8.64E-15, 7.32E-15, 6.28E-15, 5.46E-15
])  # kg/m³

msise90_mean_pressure = np.array([
    1.01E+05, 5.62E+03, 3.02E+02, 2.32E+01, 9.45E-01, 2.81E-02, 2.17E-03, 7.03E-04,
    3.31E-04, 1.80E-04, 1.05E-04, 6.44E-05, 4.09E-05, 2.66E-05, 1.77E-05, 1.20E-05,
    8.20E-06, 5.69E-06, 3.98E-06, 2.81E-06, 2.01E-06, 1.44E-06, 1.04E-06, 7.55E-07,
    5.53E-07, 4.07E-07, 3.03E-07, 2.27E-07, 1.71E-07, 1.31E-07, 1.01E-07, 7.89E-08,
    6.24E-08, 5.01E-08, 4.07E-08, 3.36E-08, 2.82E-08, 2.39E-08, 2.06E-08, 1.79E-08,
    1.58E-08, 1.40E-08, 1.26E-08, 1.14E-08, 1.04E-08, 9.47E-09
])  # Pascal

msise90_mean_molweight = np.array([
    28.9502, 28.9502, 28.9502, 28.9502, 29.0175, 27.7137, 25.8745, 24.5349, 23.4225,
    22.4106, 21.4734, 20.6108, 19.8292, 19.1337, 18.5256, 18.0015, 17.5537, 17.1721,
    16.8449, 16.5597, 16.3044, 16.0669, 15.8360, 15.6008, 15.3508, 15.0760, 14.7669,
    14.4148, 14.0125, 13.5547, 13.0389, 12.4665, 11.8428, 11.1779, 10.4854, 9.7818,
    9.0847, 8.4111, 7.7753, 7.1884, 6.6572, 6.1849, 5.7711, 5.4132, 5.1066, 4.8460
])  # kg/kmol

# ============================================================================
# TABELLA 4: MSISE-90 Model - Attività solare estremamente alta (0-900 km completo)
# ============================================================================

msise90_high_altitude = np.array([
    0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300,
    320, 340, 360, 380, 400, 420, 440, 460, 480, 500, 520, 540, 560, 580, 600,
    620, 640, 660, 680, 700, 720, 740, 760, 780, 800, 820, 840, 860, 880, 900
]) * 1000  # converti km in metri

msise90_high_temperature = np.array([
    300.2511, 206.2085, 257.6979, 244.1212, 172.2146, 297.3338, 430.8385, 875.9174,
    1143.5426, 1314.3427, 1423.6469, 1493.7864, 1538.9154, 1568.0294, 1586.8613,
    1599.0743, 1607.0154, 1612.1920, 1615.5751, 1617.7916, 1619.2476, 1620.2062,
    1620.8390, 1621.2577, 1621.5354, 1621.7200, 1621.8430, 1621.9253, 1621.9803,
    1622.0172, 1622.0421, 1622.0588, 1622.0702, 1622.0778, 1622.0830, 1622.0865,
    1622.0890, 1622.0906, 1622.0918, 1622.0925, 1622.0930, 1622.0934, 1622.0936,
    1622.0939, 1622.0940, 1622.0940
])  # Kelvin

msise90_high_density = np.array([
    1.16E+00, 9.41E-02, 4.04E-03, 3.28E-04, 1.68E-05, 2.78E-07, 2.34E-08, 4.93E-09,
    2.23E-09, 1.28E-09, 8.28E-10, 5.69E-10, 4.08E-10, 3.00E-10, 2.25E-10, 1.71E-10,
    1.32E-10, 1.03E-10, 8.05E-11, 6.35E-11, 5.04E-11, 4.02E-11, 3.23E-11, 2.60E-11,
    2.10E-11, 1.70E-11, 1.38E-11, 1.13E-11, 9.21E-12, 7.55E-12, 6.20E-12, 5.10E-12,
    4.20E-12, 3.47E-12, 2.88E-12, 2.38E-12, 1.98E-12, 1.65E-12, 1.37E-12, 1.15E-12,
    9.59E-13, 8.04E-13, 6.74E-13, 5.67E-13, 4.77E-13, 4.03E-13
])  # kg/m³

msise90_high_pressure = np.array([
    9.98E+04, 5.57E+03, 2.99E+02, 2.30E+01, 8.42E-01, 2.63E-02, 3.55E-03, 1.61E-03,
    9.90E-04, 6.76E-04, 4.86E-04, 3.60E-04, 2.72E-04, 2.08E-04, 1.61E-04, 1.26E-04,
    9.93E-05, 7.86E-05, 6.26E-05, 5.01E-05, 4.02E-05, 3.25E-05, 2.63E-05, 2.13E-05,
    1.73E-05, 1.42E-05, 1.16E-05, 9.50E-06, 7.81E-06, 6.44E-06, 5.31E-06, 4.40E-06,
    3.65E-06, 3.03E-06, 2.52E-06, 2.11E-06, 1.76E-06, 1.48E-06, 1.24E-06, 1.05E-06,
    8.84E-07, 7.48E-07, 6.36E-07, 5.42E-07, 4.63E-07, 3.97E-07
])  # Pascal

msise90_high_molweight = np.array([
    28.9502, 28.9502, 28.9502, 28.9502, 28.5290, 26.1997, 23.6456, 22.3209, 21.4577,
    20.7706, 20.1836, 19.6664, 19.2046, 18.7901, 18.4178, 18.0839, 17.7852, 17.5186,
    17.2812, 17.0699, 16.8818, 16.7142, 16.5643, 16.4297, 16.3079, 16.1967, 16.0940,
    15.9980, 15.9067, 15.8187, 15.7321, 15.6457, 15.5578, 15.4672, 15.3725, 15.2723,
    15.1653, 15.0503, 14.9260, 14.7912, 14.6447, 14.4854, 14.3123, 14.1244, 13.9210,
    13.7015
])  # kg/kmol

# ============================================================================
# TABELLA 5: Densità fino a orbita geostazionaria
# ============================================================================

extended_altitude = np.array([
    0, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800,
    850, 900, 950, 1000, 1250, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000,
    6000, 7000, 8000, 9000, 10000, 15000, 20000, 25000, 30000, 35000, 35786
]) * 1000  # converti km in metri

extended_scale_height = np.array([
    8.4, 5.9, 25.5, 37.5, 44.8, 50.3, 54.8, 58.2, 61.3, 64.5, 68.7, 74.8, 84.4,
    99.3, 121, 151, 188, 226, 263, 296, 408, 516, 829, 1220, 1590, 1900, 2180,
    2430, 2690, 3200, 3750, 4340, 4970, 5630, 9600, 14600, 20700, 27800, 36000, 37300
]) * 1000  # converti km in metri

extended_density_mean = np.array([
    1.225, 5.25E-7, 1.73E-9, 2.41E-10, 5.97E-11, 1.87E-11, 6.66E-12, 2.62E-12,
    1.09E-12, 4.76E-13, 2.14E-13, 9.89E-14, 4.73E-14, 2.36E-14, 1.24E-14, 6.95E-15,
    4.22E-15, 2.78E-15, 1.98E-15, 1.49E-15, 5.70E-16, 2.79E-16, 9.09E-17, 4.23E-17,
    2.54E-17, 1.77E-17, 1.34E-17, 1.06E-17, 8.62E-18, 6.09E-18, 4.56E-18, 3.56E-18,
    2.87E-18, 2.37E-18, 1.21E-18, 7.92E-19, 5.95E-19, 4.83E-19, 4.13E-19, 4.04E-19
])  # kg/m³

extended_density_max = np.array([
    1.225, 5.75E-7, 1.99E-9, 3.65E-10, 1.20E-10, 4.84E-11, 2.18E-11, 1.05E-11,
    5.35E-12, 2.82E-12, 1.53E-12, 8.46E-13, 4.77E-13, 2.73E-13, 1.59E-13, 9.41E-14,
    5.67E-14, 3.49E-14, 2.21E-14, 1.43E-14, 2.82E-15, 1.16E-15, 3.80E-16, 1.54E-16,
    7.09E-17, 3.67E-17, 2.11E-17, 1.34E-17, 9.30E-18, 5.41E-18, 3.74E-18, 2.87E-18,
    2.34E-18, 1.98E-18, 1.16E-18, 8.42E-19, 6.81E-19, 5.84E-19, 5.21E-19, 5.12E-19
])  # kg/m³

# ============================================================================
# SALVA TUTTI GLI ARRAY IN UN FILE .npz
# ============================================================================

np.savez_compressed(
    'atmospheric_data.npz',
    
    # U.S. Standard Atmosphere 1976
    ussa1976_altitude=ussa1976_altitude,
    ussa1976_temperature=ussa1976_temperature,
    ussa1976_pressure=ussa1976_pressure,
    ussa1976_density=ussa1976_density,
    ussa1976_viscosity=ussa1976_viscosity,
    
    # MSISE-90 Low Solar Activity (completo 0-900 km)
    msise90_low_altitude=msise90_low_altitude,
    msise90_low_temperature=msise90_low_temperature,
    msise90_low_density=msise90_low_density,
    msise90_low_pressure=msise90_low_pressure,
    
    # MSISE-90 Mean Solar Activity (completo 0-900 km)
    msise90_mean_altitude=msise90_mean_altitude,
    msise90_mean_temperature=msise90_mean_temperature,
    msise90_mean_density=msise90_mean_density,
    msise90_mean_pressure=msise90_mean_pressure,
    msise90_mean_molweight=msise90_mean_molweight,
    
    # MSISE-90 High Solar Activity (completo 0-900 km)
    msise90_high_altitude=msise90_high_altitude,
    msise90_high_temperature=msise90_high_temperature,
    msise90_high_density=msise90_high_density,
    msise90_high_pressure=msise90_high_pressure,
    msise90_high_molweight=msise90_high_molweight,
    
    # Extended atmosphere (to GEO)
    extended_altitude=extended_altitude,
    extended_scale_height=extended_scale_height,
    extended_density_mean=extended_density_mean,
    extended_density_max=extended_density_max
)

print("✓ File 'atmospheric_data.npz' salvato con successo!")
print("\n" + "="*70)
print("CONTENUTO DEL FILE:")
print("="*70)

print("\n1. U.S. Standard Atmosphere 1976 (-2 km a 84.852 km):")
print("   - ussa1976_altitude (metri)")
print("   - ussa1976_temperature (K)")
print("   - ussa1976_pressure (Pa)")
print("   - ussa1976_density (kg/m³)")
print("   - ussa1976_viscosity (N-s/m²)")

print("\n2. MSISE-90 Bassa Attività Solare (0-900 km) - 46 punti:")
print("   - msise90_low_altitude (metri)")
print("   - msise90_low_temperature (K)")
print("   - msise90_low_density (kg/m³)")
print("   - msise90_low_pressure (Pa)")

print("\n3. MSISE-90 Attività Solare Media (0-900 km) - 46 punti:")
print("   - msise90_mean_altitude (metri)")
print("   - msise90_mean_temperature (K)")
print("   - msise90_mean_density (kg/m³)")
print("   - msise90_mean_pressure (Pa)")
print("   - msise90_mean_molweight (kg/kmol)")

print("\n4. MSISE-90 Attività Solare Estremamente Alta (0-900 km) - 46 punti:")
print("   - msise90_high_altitude (metri)")
print("   - msise90_high_temperature (K)")
print("   - msise90_high_density (kg/m³)")
print("   - msise90_high_pressure (Pa)")
print("   - msise90_high_molweight (kg/kmol)")

print("\n5. Dati Estesi fino a Orbita Geostazionaria (0-35,786 km):")
print("   - extended_altitude (metri)")
print("   - extended_scale_height (metri)")
print("   - extended_density_mean (kg/m³)")
print("   - extended_density_max (kg/m³)")

print("\n" + "="*70)
print("ESEMPIO DI CARICAMENTO:")
print("="*70)
print("""
import numpy as np

# Carica tutti i dati
data = np.load('atmospheric_data.npz')

# Accedi ai singoli array
altitudini = data['ussa1976_altitude']
densita = data['ussa1976_density']

# Oppure carica direttamente quello che ti serve
with np.load('atmospheric_data.npz') as data:
    alt = data['extended_altitude']
    dens_mean = data['extended_density_mean']
    
# Lista tutti gli array disponibili
print(data.files)
""")
print("="*70)